BEGIN{OFS="\t"} NR==1{prev=$2; next} {d=$2-prev; prev=$2; diffs[NR-1]=d; if(d<-1e-12) v+=1; s1+=d; s2+=d*d; n+=1} END{mean=(n?s1/n:0); var=(n? (s2/n - mean*mean):0); num=0; den1=0; den2=0; for(i=2;i<=n;i++){ x=diffs[i-1]; y=diffs[i]; num+=x*y; den1+=x*x; den2+=y*y } r=(den1>0&&den2>0? num/sqrt(den1*den2):0); score=(1000*v + 100*(r>0?r:0) + (var>0?var:0)); printf "score\t%.9f\tviol\t%d\tr1\t%.6f\n",score,v,r }
